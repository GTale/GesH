' 需在VBA模块中声明API函数
#If VBA7 Then
    Declare PtrSafe Function CreateWindowEx Lib "user32" Alias "CreateWindowExA" _
        (ByVal dwExStyle As Long, ByVal lpClassName As String, _
        ByVal lpWindowName As String, ByVal dwStyle As Long, _
        ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, _
        ByVal nHeight As Long, ByVal hWndParent As Long, _
        ByVal hMenu As Long, ByVal hInstance As Long, _
        ByVal lpParam As Long) As Long
    
    Declare PtrSafe Function GetDC Lib "user32" (ByVal hWnd As Long) As Long
    Declare PtrSafe Function Polygon Lib "gdi32" (ByVal hdc As Long, _
        lpPoint As POINTAPI, ByVal nCount As Long) As Long
    Type POINTAPI
        x As Long
        y As Long
    End Type
#End If

Sub DrawHeart()
    Dim hWnd As Long, hdc As Long
    Dim points(29) As POINTAPI  ' 30个点定义心形
    
    ' 创建透明窗口
    hWnd = CreateWindowEx(&H80088, "STATIC", "Heart", &H80000000, _
        0, 0, 400, 400, 0, 0, 0, 0)
    hdc = GetDC(hWnd)
    
    ' 心形坐标点（需数学计算生成）
    For i = 0 To 29
        angle = 2 * 3.1415926 * i / 30
        points(i).x = 200 + 50 * (16 * Sin(angle) ^ 3)
        points(i).y = 200 - 50 * (13 * Cos(angle) - 5 * Cos(2 * angle) - _
                       2 * Cos(3 * angle) - Cos(4 * angle))
    Next
    
    ' 绘制多边形
    Polygon hdc, points(0), 30
End Sub
